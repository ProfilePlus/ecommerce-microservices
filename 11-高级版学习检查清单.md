# 云原生高级版学习检查清单

## 📋 使用说明

本清单帮助你系统学习《实战项目云原生高级版部署指南》，每完成一项就打勾 ✅

---

## 第一部分：Kubernetes 生产级部署

### 1.1 基础知识
- [ ] 理解 K8s 的核心概念（Pod、Service、Deployment）
- [ ] 理解为什么需要 K8s（vs Docker Compose）
- [ ] 了解 K8s 的架构（Master、Node、etcd）

### 1.2 集群搭建
- [ ] 成功安装 K3s 集群
- [ ] 配置 kubectl，能执行基本命令
- [ ] 查看节点状态：`kubectl get nodes`
- [ ] 查看所有 Pod：`kubectl get pods -A`

### 1.3 Helm 使用
- [ ] 成功安装 Helm
- [ ] 添加常用 Chart 仓库
- [ ] 使用 Helm 部署 PostgreSQL
- [ ] 使用 Helm 部署 Redis
- [ ] 使用 Helm 部署 Kafka

### 1.4 微服务 Helm 化
- [ ] 创建订单服务的 Helm Chart
- [ ] 编写 Chart.yaml
- [ ] 配置 values.yaml
- [ ] 编写 Deployment 模板
- [ ] 编写 Service 模板
- [ ] 成功部署订单服务到 K8s
- [ ] 查看 Pod 日志：`kubectl logs -f`

### 1.5 HPA 自动扩缩容
- [ ] 理解 HPA 工作原理
- [ ] 配置 HPA（CPU、内存阈值）
- [ ] 压测触发扩容
- [ ] 观察 Pod 数量变化
- [ ] 验证自动缩容

### 1.6 Ingress 配置
- [ ] 理解 Ingress 的作用
- [ ] 安装 Ingress Controller
- [ ] 创建 Ingress 规则
- [ ] 配置域名访问
- [ ] 测试通过域名访问服务

### 1.7 配置管理
- [ ] 创建 ConfigMap
- [ ] 创建 Secret
- [ ] 在 Pod 中引用 ConfigMap
- [ ] 在 Pod 中引用 Secret
- [ ] 验证配置生效

**检查点**：能用 Helm 部署完整的微服务到 K8s，支持自动扩缩容

---

## 第二部分：Istio 服务网格

### 2.1 Istio 基础
- [ ] 理解服务网格的概念
- [ ] 理解 Istio 的核心功能
- [ ] 理解 Sidecar 模式

### 2.2 Istio 安装
- [ ] 下载 Istio
- [ ] 安装 Istio（demo profile）
- [ ] 验证 Istio 组件运行正常
- [ ] 为命名空间启用 Sidecar 注入
- [ ] 重新部署应用，验证 Sidecar 注入成功

### 2.3 灰度发布（金丝雀）
- [ ] 部署两个版本（v1、v2）
- [ ] 创建 VirtualService
- [ ] 创建 DestinationRule
- [ ] 配置 10% 流量到 v2
- [ ] 测试流量分配
- [ ] 逐步调整流量比例（50%、100%）
- [ ] 完全切换到 v2
- [ ] 下线 v1

### 2.4 A/B 测试
- [ ] 配置基于请求头的路由
- [ ] 测试 iOS 用户访问 v2
- [ ] 测试 Android 用户访问 v1
- [ ] 验证 A/B 测试效果

### 2.5 蓝绿部署
- [ ] 理解蓝绿部署原理
- [ ] 配置蓝绿环境
- [ ] 一键切换流量
- [ ] 快速回滚

### 2.6 熔断和重试
- [ ] 配置连接池限制
- [ ] 配置熔断规则
- [ ] 压测触发熔断
- [ ] 观察熔断效果

### 2.7 服务间加密
- [ ] 配置 PeerAuthentication
- [ ] 启用 mTLS STRICT 模式
- [ ] 验证服务间通信加密

**检查点**：能用 Istio 实现灰度发布、蓝绿部署，掌握流量管理

---

## 第三部分：JVM 性能调优

### 3.1 JVM 参数配置
- [ ] 理解堆内存配置（-Xms、-Xmx）
- [ ] 理解 GC 收集器选择
- [ ] 理解 GC 日志参数
- [ ] 配置不同场景的 JVM 参数
  - [ ] 高吞吐场景
  - [ ] 低延迟场景
  - [ ] 大内存场景

### 3.2 GC 日志分析
- [ ] 从 Pod 中复制 GC 日志
- [ ] 使用 GCViewer 分析 GC 日志
- [ ] 识别关键指标
  - [ ] Young GC 频率和时间
  - [ ] Full GC 频率和时间
  - [ ] 堆内存使用率
  - [ ] GC 总时间占比
- [ ] 判断 GC 是否正常

### 3.3 Arthas 在线诊断
- [ ] 在容器中安装 Arthas
- [ ] 启动 Arthas
- [ ] 使用 dashboard 查看 JVM 概览
- [ ] 使用 thread 查看线程信息
- [ ] 使用 thread -b 查看死锁
- [ ] 使用 monitor 监控方法执行
- [ ] 使用 watch 查看方法参数和返回值
- [ ] 使用 trace 追踪方法调用链
- [ ] 使用 profiler 生成火焰图
- [ ] 分析火焰图找出 CPU 热点

### 3.4 内存泄漏排查
- [ ] 理解 OOM 的原因
- [ ] 配置 -XX:+HeapDumpOnOutOfMemoryError
- [ ] 手动生成堆转储（jmap）
- [ ] 使用 MAT 打开 heapdump
- [ ] 分析 Leak Suspects
- [ ] 分析 Dominator Tree
- [ ] 找出占用最多内存的对象
- [ ] 定位内存泄漏代码

### 3.5 常见问题处理
- [ ] 识别并修复 ThreadLocal 泄漏
- [ ] 识别并修复集合类持续增长
- [ ] 使用 Guava Cache 或 Caffeine 替代原生 Map

**检查点**：能分析 GC 日志、使用 Arthas 诊断问题、排查内存泄漏

---

## 第四部分：数据库深度优化

### 4.1 索引优化
- [ ] 理解 B-Tree 索引原理
- [ ] 使用 EXPLAIN 查看执行计划
- [ ] 识别全表扫描
- [ ] 创建单列索引
- [ ] 创建复合索引
- [ ] 理解最左前缀原则
- [ ] 创建部分索引
- [ ] 创建覆盖索引
- [ ] 避免索引失效的场景

### 4.2 慢查询优化
- [ ] 开启慢查询日志
- [ ] 查看慢查询列表
- [ ] 使用 EXPLAIN ANALYZE 分析
- [ ] 优化：避免 SELECT *
- [ ] 优化：分页查询
- [ ] 优化：IN 改为 EXISTS
- [ ] 优化：子查询改为 JOIN
- [ ] 验证优化效果

### 4.3 读写分离
- [ ] 配置 PostgreSQL 主从复制
- [ ] 创建复制用户
- [ ] 在从库执行基础备份
- [ ] 验证主从复制状态
- [ ] 配置应用层读写分离
- [ ] 写操作使用主库
- [ ] 读操作使用从库
- [ ] 监控主从延迟

### 4.4 连接池优化
- [ ] 理解 HikariCP 参数
- [ ] 配置合适的连接池大小
- [ ] 配置连接超时时间
- [ ] 配置空闲连接回收
- [ ] 监控连接池状态
- [ ] 处理连接泄漏

**检查点**：能优化慢查询、配置读写分离、调优连接池

---

## 第五部分：完整监控告警

### 5.1 Prometheus 指标监控
- [ ] 理解 Counter、Gauge、Histogram
- [ ] 创建自定义业务指标
  - [ ] 订单创建总数
  - [ ] 订单失败总数
  - [ ] 订单金额分布
- [ ] 在代码中记录指标
- [ ] 配置 Prometheus 采集
- [ ] 在 Prometheus 查询指标

### 5.2 Grafana 告警
- [ ] 登录 Grafana
- [ ] 创建告警规则
  - [ ] CPU 使用率 > 80%
  - [ ] 内存使用率 > 90%
  - [ ] 接口响应时间 > 1s
  - [ ] 订单失败率 > 5%
- [ ] 配置通知渠道
  - [ ] 企业微信
  - [ ] 钉钉
  - [ ] 邮件
- [ ] 测试告警触发
- [ ] 验证通知送达

### 5.3 日志优化
- [ ] 配置 Logback 输出 JSON 格式
- [ ] 添加 TraceId 到日志
- [ ] 配置 Logstash 采集
- [ ] 在 Kibana 查看日志
- [ ] 创建日志查询
  - [ ] 按 TraceId 查询
  - [ ] 按错误级别查询
  - [ ] 按服务查询
- [ ] 创建日志告警

**检查点**：有完整的监控告警体系，能快速发现和定位问题

---

## 第六部分：支付系统设计

### 6.1 支付流程
- [ ] 理解支付流程
- [ ] 创建支付订单
- [ ] 实现幂等性保证（分布式锁）
- [ ] 调用第三方支付接口
- [ ] 处理支付回调
- [ ] 验证签名
- [ ] 更新订单状态
- [ ] 发送支付成功消息

### 6.2 对账系统
- [ ] 理解对账的必要性
- [ ] 获取本地支付订单
- [ ] 获取第三方账单
- [ ] 实现对账逻辑
- [ ] 处理对账差异
- [ ] 配置定时任务（每天凌晨）
- [ ] 测试对账流程

### 6.3 退款流程
- [ ] 创建退款订单
- [ ] 检查订单状态
- [ ] 调用第三方退款接口
- [ ] 异步处理退款
- [ ] 更新退款状态
- [ ] 发送退款成功消息

**检查点**：掌握支付系统核心流程，理解幂等性和对账

---

## 第七部分：多机房容灾

### 7.1 架构设计
- [ ] 理解多机房架构
- [ ] 理解主备机房的区别
- [ ] 理解数据同步方案

### 7.2 数据同步
- [ ] 部署 Canal 服务
- [ ] 配置 Canal 监听 Binlog
- [ ] 消费 Canal 数据
- [ ] 发送到 Kafka
- [ ] 备机房消费 Kafka
- [ ] 写入备库

### 7.3 故障切换
- [ ] 实现健康检查
- [ ] 检测数据库不健康
- [ ] 触发故障切换
- [ ] 更新 DNS 记录
- [ ] 通知应用切换
- [ ] 发送告警

**检查点**：理解多机房容灾架构，掌握数据同步和故障切换

---

## 第八部分：性能优化

### 8.1 优化指标
- [ ] 记录优化前的性能指标
  - [ ] 接口响应时间
  - [ ] QPS
  - [ ] 数据库连接数
  - [ ] 内存使用
  - [ ] GC 停顿时间
- [ ] 记录优化后的性能指标
- [ ] 计算提升幅度

### 8.2 压测
- [ ] 安装 JMeter
- [ ] 创建测试计划
- [ ] 配置并发用户数
- [ ] 执行压测
- [ ] 收集压测数据
- [ ] 分析瓶颈
- [ ] 优化后再次压测
- [ ] 对比优化效果

**检查点**：有完整的优化前后对比数据和压测报告

---

## 第九部分：面试准备

### 9.1 核心问题准备
- [ ] 准备答案：你们项目是如何部署的？
  - [ ] 提到 Kubernetes
  - [ ] 提到 Helm
  - [ ] 提到 HPA
  - [ ] 提到灰度发布
- [ ] 准备答案：如何保证系统高可用？
  - [ ] 应用层高可用
  - [ ] 数据层高可用
  - [ ] 中间件高可用
  - [ ] 容灾方案
  - [ ] 监控告警
- [ ] 准备答案：遇到过什么性能问题？
  - [ ] 具体问题描述
  - [ ] 排查过程
  - [ ] 根本原因
  - [ ] 解决方案
  - [ ] 优化效果
  - [ ] 经验总结
- [ ] 准备答案：如何做灰度发布？
  - [ ] 使用 Istio
  - [ ] 具体步骤
  - [ ] 流量比例调整
  - [ ] 高级玩法
  - [ ] 回滚策略
- [ ] 准备答案：JVM 调优做过哪些？
  - [ ] 具体案例
  - [ ] 问题现象
  - [ ] 排查工具
  - [ ] 解决方案
  - [ ] 优化效果
  - [ ] 经验总结

### 9.2 项目亮点总结
- [ ] 整理技术亮点（至少 6 点）
- [ ] 整理业务亮点（至少 3 点）
- [ ] 准备性能数据
  - [ ] QPS 提升
  - [ ] 响应时间降低
  - [ ] 可用性数据

### 9.3 项目演示准备
- [ ] 录制项目演示视频（5-10 分钟）
- [ ] 准备架构图（PPT 或 draw.io）
- [ ] 准备监控截图
- [ ] 准备压测报告

### 9.4 简历准备
- [ ] 更新简历项目描述
- [ ] 突出云原生技术
- [ ] 突出性能优化
- [ ] 突出高可用架构
- [ ] 突出量化数据

**检查点**：能清晰回答所有面试问题，有完整的项目演示材料

---

## 综合自测

### 理论知识
- [ ] 能画出 Kubernetes 架构图
- [ ] 能解释 HPA 工作原理
- [ ] 能解释 Istio 服务网格原理
- [ ] 能解释 JVM 内存模型
- [ ] 能解释 G1 收集器原理
- [ ] 能解释数据库索引原理
- [ ] 能解释主从复制原理
- [ ] 能解释多机房容灾方案

### 实战能力
- [ ] 能独立部署完整的微服务到 K8s
- [ ] 能配置 HPA 自动扩缩容
- [ ] 能用 Istio 实现灰度发布
- [ ] 能分析 GC 日志
- [ ] 能使用 Arthas 诊断问题
- [ ] 能优化慢查询
- [ ] 能配置读写分离
- [ ] 能设计支付系统

### 面试能力
- [ ] 能流畅回答部署相关问题
- [ ] 能流畅回答高可用相关问题
- [ ] 能流畅回答性能优化相关问题
- [ ] 能流畅回答灰度发布相关问题
- [ ] 能流畅回答 JVM 调优相关问题
- [ ] 有真实的优化案例和数据

---

## 🎯 完成标准

### 基础完成（60%）
- ✅ 完成 K8s 部署
- ✅ 完成 HPA 配置
- ✅ 完成 JVM 调优
- ✅ 完成数据库优化

### 良好完成（80%）
- ✅ 基础完成的所有内容
- ✅ 完成 Istio 灰度发布
- ✅ 完成监控告警
- ✅ 准备好面试答案

### 优秀完成（100%）
- ✅ 良好完成的所有内容
- ✅ 完成支付系统
- ✅ 完成多机房容灾
- ✅ 有完整的项目演示材料

---

## 📊 学习进度跟踪

### 第1周进度
- 完成章节：__________
- 学习时间：__________
- 遇到的问题：__________
- 解决方案：__________

### 第2周进度
- 完成章节：__________
- 学习时间：__________
- 遇到的问题：__________
- 解决方案：__________

### 第3周进度
- 完成章节：__________
- 学习时间：__________
- 遇到的问题：__________
- 解决方案：__________

### 第4周进度
- 完成章节：__________
- 学习时间：__________
- 遇到的问题：__________
- 解决方案：__________

---

## 💪 激励语录

- 🎯 **每天进步一点点，就是成功的开始**
- 🚀 **困难只是暂时的，坚持就能突破**
- 💡 **理解原理比记住结论更重要**
- 🛠️ **动手实践是最好的学习方式**
- 📝 **及时总结能加深理解**

---

## 📞 学习建议

1. **不要急于求成**
   - 每个章节都要理解透彻
   - 所有实战都要亲自动手
   - 不要跳过基础部分

2. **及时记录总结**
   - 每天记录学习笔记
   - 遇到的问题和解决方案
   - 理解的关键点

3. **定期复习**
   - 每周复习本周学习内容
   - 每月复习本月学习内容
   - 面试前全面复习

4. **寻求帮助**
   - 遇到问题先自己思考
   - Google/Stack Overflow
   - 技术社区提问
   - 和同学讨论

---

**记住：学习是一个循序渐进的过程，不要着急，稳扎稳打才能走得更远！**

**加油！你一定可以的！💪**

